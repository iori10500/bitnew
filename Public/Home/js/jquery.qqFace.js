(function(b){b.fn.qqFace=function(i){var m={id:"facebox",path:"face/",assign:"content",tip:"#"};var j=b.extend(m,i);var a=b("#"+j.assign);var n=j.id;var l=j.path;var k=j.tip;if(a.length<=0){alert("缺少表情赋值对象。");return false}b(this).click(function(e){var h,g;if(b("#"+n).length<=0){h='<div id="'+n+'" style="position:fixed;display:none;z-index:1000;background: #fff;" class="qqFace"><table border="0" cellspacing="0" cellpadding="0"><tr>';for(var c=1;c<=75;c++){g="[/"+k+c+"]";h+='<td><img src="'+l+c+'.gif" onclick="$(\'#'+j.assign+"').setCaret();$('#"+j.assign+"').insertAtCaret('"+g+"');\" /></td>";if(c%15==0){h+="</tr><tr>"}}h+="</tr></table></div>"}b("body").append(h);var f=b(this).position();var d=f.top+b(this).outerHeight()-160;b("#"+n).css("bottom","40px");b("#"+n).css("right","15px");b("#"+n).show();e.stopPropagation()});b(document).click(function(){b("#"+n).hide();b("#"+n).remove()})}})(jQuery);jQuery.extend({unselectContents:function(){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}}});jQuery.fn.extend({selectContents:function(){$(this).each(function(h){var j=this;var i,g,l,k;if((l=j.ownerDocument)&&(k=l.defaultView)&&typeof k.getSelection!="undefined"&&typeof l.createRange!="undefined"&&(i=window.getSelection())&&typeof i.removeAllRanges!="undefined"){g=l.createRange();g.selectNode(j);if(h==0){i.removeAllRanges()}i.addRange(g)}else{if(document.body&&typeof document.body.createTextRange!="undefined"&&(g=document.body.createTextRange())){g.moveToElementText(j);g.select()}}})},setCaret:function(){if(!$.browser.msie){return}var b=function(){var a=$(this).get(0);a.caretPos=document.selection.createRange().duplicate()};$(this).click(b).select(b).keyup(b)},insertAtCaret:function(k){var j=$(this).get(0);if(document.all&&j.createTextRange&&j.caretPos){var l=j.caretPos;l.text=l.text.charAt(l.text.length-1)==""?k+"":k}else{if(j.setSelectionRange){var o=j.selectionStart;var n=j.selectionEnd;var p=j.value.substring(0,o);var m=j.value.substring(n);j.value=p+k+m;j.focus();var i=k.length;j.setSelectionRange(o+i,o+i);j.blur()}else{j.value+=k}}}});