btc_rmb_ajax=10;ybc_rmb_loan=10;var widthNumArr={goc:0.05,btc:10,ltc:0.1,lc:0.005,lsk:0.005,eth:0.5,etc:0.2};function badFloat(b,c){if(isNaN(b)){return true}b+="";if(-1==b.indexOf(".")){return false}var a=b.split(".");if(a[1].length>c){return true}return false}function formatfloat(b,e,a){b=parseFloat(b);var d=[];if(e==2){d=[100,0.01]}if(e==3){d=[1000,0.001]}if(e==4){d=[10000,0.0001]}if(e==5){d=[100000,1e-05]}if(e==6){d=[1000000,1e-06]}if(e==7){d=[10000000,1e-07]}if(e==8){d=[100000000,1e-08]}var c=Math.floor(b*d[0])/d[0];if(a&&b>c){c+=d[1]}return c}function loanformatfloat(b,e,a){b=parseFloat(b);var d;if(e==2){d=[100,0.01]}else{if(e==3){d=[1000,0.001]}else{if(e==5){d=[100000,1e-05]}else{return b}}}var c=Math.round(b*d[0])/d[0];if(a&&b>c){c+=d[1]}return c}function Dom(a){return document.getElementById(a)}function ua_refresh(c){ua_cny=Dom("ua_cny");Dom("ua_cny_over").innerHTML=formatfloat(user.cny_over,4)+" 元";Dom("ua_cny_lock").innerHTML=formatfloat(user.cny_lock,4)+" 元";var a={};for(var b in c){Dom("ua_"+c[b]+"_over").innerHTML=formatfloat(user[c[b]+"_over"],5)+" "+c[b].toUpperCase();Dom("ua_"+c[b]+"_lock").innerHTML=formatfloat(user[c[b]+"_lock"],5)+" "+c[b].toUpperCase()}if(btc_rmb_ajax==10){$.get("/market/coinprice",function(d){var h=parseFloat(user.cny_lock)+parseFloat(user.cny_over);for(var e in c){var f=c[e]+"_cny_rmb";var g=parseFloat(d[f]);if(g){h+=(parseFloat(user[c[e]+"_lock"])+parseFloat(user[c[e]+"_over"]))*g}}ua_cny.innerHTML=formatfloat(h,5).toFixed(2)},"json");btc_rmb_ajax=0}btc_rmb_ajax++}function btcsum(c,b,e,d){var a=b.split("_");$.get("/json/"+b+"_sum",function(g){for(var m in g){var f=g[m];var h="";var k="";for(var j in f){if(c&&j==c){break}var l=parseFloat(f[j].n),n=l*widthNumArr[a[0]]>289?289:l*widthNumArr[a[0]];k='<td class="'+(m=="buy"?"buy":"sell")+'" style="width:50px;">'+(m=="buy"?"买":"卖")+"("+(parseInt(j)+1)+")</td>";h+='<tr style="position:relative;">'+k+'<td style="padding-left:5px; text-align:left;">￥'+parseFloat(f[j].p)+'</td><td style="padding-left:5px; text-align:left;">'+l+'</td><td style="width:'+n+'px" style="border:0;" class="'+(m=="buy"?"sell":"buy")+'Span"></td></tr>'}$("#"+m+"list").html(h);$("#"+b+"_"+m+"one").html(typeof f[0]=="undefined"?0:Number(f[0].p).toFixed(e))}if(g.sale.length!=0){$("#bpricenice").html(Number(g.sale[0].p).toFixed(e));if(user.length!=0){$("#buy_max").html(formatfloat(user.cny_over/Number(g.sale[0].p)-Math.pow(10,-d),d,0))}}if(g.buy.length!=0){$("#spricenice").html(Number(g.buy[0].p).toFixed(e))}},"json")}function btcorder(c,a,b,e,d){$.get("/json/"+a+"_order",function(g){var h="";for(var j in g.d){if(c&&j>c){break}if(30==c){h+="<tr><td>"+g.d[j].t+'</td><!--<td class="'+g.d[j].s+'">'+(g.d[j].s=="buy"?"买入":"卖出")+'</td>--><td class="'+g.d[j].s+'" style="padding-left:5px; text-align:left;">￥'+g.d[j].p+'</td><td style="padding-left:5px; text-align:left;">'+g.d[j].n+"</td></tr>"}else{h+="<tr><td>"+g.d[j].t+'</td><td class="'+g.d[j].s+'">￥'+g.d[j].p+'</td><td class="tableEnd">Ф '+g.d[j].n+"</td></tr>"}}$("#orderlist").html(h);if(typeof g.d[0]=="undefined"){g.d[0]={p:"0.0"}}g.d[0].p=g.d[0].p+"";var k=g.d[0].p.split(".");var f=formatfloat(g.d[0].p);if(k.length==1){k[1]="00"}$("#"+a+"_rmb_box").html("￥"+k[0]+"<b>."+(k[1].substring(0,e))+"</b>");$("#"+a+"_rmb_new").html(formatfloat(g.d[0].p,e));$("#"+a+"_rmb_new").html(formatfloat(g.d[0].p,e));$("#"+a+"_min_box").html(g.min);$("#"+a+"_max_box").html(g.max);$("#"+a+"_sum_box").html(formatfloat(g.sum,d));var l=(parseFloat(g.min)+parseFloat(g.max))/2;l=((f-l)/l*100).toString().split(".");if(typeof l[1]=="undefined"){l=["0","0"]}$("#"+a+"_zd_box").html(l[0]+"."+l[1].substr(0,2)+"%");document.title=b+g.d[0].p+" | 交易中心-爱币网-安全数字货币交易平台";setTimeout("btcorder("+c+",'"+a+"', '"+b+"', "+e+", "+d+")",6000)},"json")}function mytrust(d,a,c,b){$.get("/ajax/mytrust/coin/"+a+"/type/"+d,function(e){var f="";var h=e.data.length;if(h>0){for(var g=0;g<h;g++){if(g%2==0){f+='<tr bgcolor="#E6F0E6" id=\'tru'+e.data[g].id+"'> "}else{f+='<tr bgcolor="#F5F5F1" id=\'tru'+e.data[g].id+"'>"}if(e.data[g].flag=="buy"){f+='<td class="ttbtn">买</td>'}else{f+='<td class="trbtn">卖</td>'}f+="<td>￥"+formatfloat(e.data[g].price,c,0)+"</td>";f+="<td>"+formatfloat(e.data[g].numberover,b,0)+"</td>";f+='<td><a class="remove" href="javascript:void(0);" onclick="trustcancel('+e.data[g].id+","+d+", '"+a+"',"+b+')">撤销</a></td>';f+="</tr>"}}else{f="<tr><td colspan=4>暂无未交易的委托</td></tr>"}$("#mytrustlist").html(f);setTimeout("mytrust("+d+', "'+a+'", '+c+", "+b+")",6000)},"json")}function socketConnection(d,b,c,f,e){if(!window.WebSocket){btcsum(d,b,f,e);btcorder(d,b,c,f,e);return false}var a=b.split("_");if(parseInt(isonline)==1){var h="wss://real.qqibtc.com:13442"}else{if(parseInt(isonline)==2){var h="wss://real.abwang.com:13442"}else{var h="ws://real.5ituya.com:13442"}}var g=io.connect(h);g.on("connect",function(){});g.on("message"+b,function(r){var l=r.sum;l=JSON.parse(l);for(var s in l){var k=l[s];var m="";var o="";for(var n in k){if(d&&n==d){break}var p=parseFloat(k[n].n),t=p*widthNumArr[a[0]]>289?289:p*widthNumArr[a[0]];o='<td class="'+(s=="buy"?"buy":"sell")+'" style="width:50px;">'+(s=="buy"?"买":"卖")+"("+(parseInt(n)+1)+")</td>";m+='<tr style="position:relative;">'+o+'<td style="padding-left:5px; text-align:left;">￥'+parseFloat(k[n].p)+'</td><td style="padding-left:5px; text-align:left;">'+p+'</td><td style="width:'+t+'px" style="border:0;" class="'+(s=="buy"?"sell":"buy")+'Span"></td></tr>'}$("#"+s+"list").html(m);$("#"+b+"_"+s+"one").html(typeof k[0]=="undefined"?0:Number(k[0].p).toFixed(f))}if(l.sale.length!=0){$("#bpricenice").html(Number(l.sale[0].p).toFixed(f));if(user.length!=0){$("#buy_max").html(formatfloat(user.cny_over/Number(l.sale[0].p)-Math.pow(10,-e),e,0))}}if(l.buy.length!=0){$("#spricenice").html(Number(l.buy[0].p).toFixed(f))}var k=r.order;k=JSON.parse(k);var m="";for(var n in k.d){if(d&&n>d){break}if(30==d){m+="<tr><td>"+k.d[n].t+'</td><!--<td class="'+k.d[n].s+'">'+(k.d[n].s=="buy"?"买入":"卖出")+'</td>--><td class="'+k.d[n].s+'" style="padding-left:5px; text-align:left;">￥'+k.d[n].p+'</td><td style="padding-left:5px; text-align:left;">'+k.d[n].n+"</td></tr>"}else{m+="<tr><td>"+k.d[n].t+'</td><td class="'+k.d[n].s+'">￥'+k.d[n].p+'</td><td class="tableEnd">Ф '+k.d[n].n+"</td></tr>"}}$("#orderlist").html(m);if(typeof k.d[0]=="undefined"){k.d[0]={p:"0.0"}}k.d[0].p=k.d[0].p+"";var q=k.d[0].p.split(".");var j=formatfloat(k.d[0].p);if(q.length==1){q[1]="00"}$("#"+b+"_rmb_box").html("￥"+q[0]+"<b>."+(q[1].substring(0,f))+"</b>");$("#"+b+"_rmb_new").html(formatfloat(k.d[0].p,f));$("#"+b+"_rmb_new").html(formatfloat(k.d[0].p,f));$("#"+b+"_min_box").html(k.min);$("#"+b+"_max_box").html(k.max);$("#"+b+"_sum_box").html(formatfloat(k.sum,e));var u=(parseFloat(k.min)+parseFloat(k.max))/2;u=((j-u)/u*100).toString().split(".");if(typeof u[1]=="undefined"){u=["0","0"]}$("#"+b+"_zd_box").html(u[0]+"."+u[1].substr(0,2)+"%");document.title=c+k.d[0].p+" | 交易中心-爱币网-安全数字货币交易平台"});g.on("connect_failed",function(){});g.on("error",function(){});g.on("reconnecting",function(){});g.on("reconnect",function(){});g.on("disconnect",function(){console.log("disconnect")})}function hourprice(a){$.get("/"+a+"_hour_price?t="+Math.random(),function(b){$("#hour_price").html(b);setTimeout("hourprice()",30000)},"json")}function yestprice(b){var a=new Date();datenow=a.getFullYear()+((a.getMonth()+1)<10?"0":"")+(a.getMonth()+1)+(a.getDate()<10?"0":"")+a.getDate();$.get("/dayprice/"+b+"_"+datenow+"?t="+Math.random(),function(c){$("#hour_price").html(c)},"json")}function ajaxtrustcancel(a,b){$.get("/ajax/trustcancel/id/"+a+"/type/"+b,function(c){alert(c.msg);if(c.status){$("#t_s_"+a).addClass("cancel");$("#t_s_"+a).html("已撤销");$("#t_opt_"+a).html("")}},"json")}function trustcancel(b,d,a,c){$.get("/ajax/trustcancel/id/"+b+"/type/"+d,function(e){$("#tErrorTips").html(e.msg).show();if(e.status){$("#tru"+b).remove();for(var f in e.data){user[f]=e.data[f]}freshAsset(user,a,c);setTimeout(function(){$("#tErrorTips").hide()},2000)}},"json")}function freshAsset(d,b,c){var a=parseFloat($("#bpricenice").html());$("#buy_max").html(formatfloat(d.cny_over/a,c,0));$("#sell_max").html(formatfloat(d[b+"_over"],c,0));$("#header_over_cny").html(parseFloat(d.cny_over));$("#header_over_"+b).html(parseFloat(d[b+"_over"]));$("#header_lock_cny").html(parseFloat(d.cny_lock));$("#header_lock_"+b).html(parseFloat(d[b+"_lock"]))}function html5_save(){var c=getCookie("YBCUUID");if(window.localStorage&&!localStorage.getItem("YBCUUID")){localStorage.setItem("YBCUUID",c)}else{if(window.localStorage&&localStorage.getItem("YBCUUID")){var a=localStorage.getItem("YBCUUID")}}if(window.sessionStorage&&!sessionStorage.getItem("YBCUUID")){sessionStorage.setItem("YBCUUID",c)}else{if(window.sessionStorage&&sessionStorage.getItem("YBCUUID")){var b=sessionStorage.getItem("YBCUUID")}}}function getCookie(c){var a=document.cookie.split("; ");for(var b=0;b<a.length;b++){var d=a[b].split("=");if(d[0]==c){return unescape(d[1])}}}function delCookie(a){document.cookie=a+"=;expires="+(new Date(0)).toGMTString()}function SetCookie(c,d){var a=30;var b=new Date();b.setTime(b.getTime()+31536000);document.cookie=c+"="+escape(d)+";expires="+b.toGMTString()}function addCookie(d,e,c){var f=d+"="+escape(e);if(c>0){var a=new Date();var b=31536000;a.setTime(a.getTime()+b);f+="; expires="+a.toGMTString()}document.cookie=f}function sendmsg(b,c,a){if($(b).attr("class")=="aButton2"){return}$.post("/ajax/sendmsg",{type:c,name:a},function(d){if(d==1){time(b);$("#errorTips").hide();return false}if(d==0){$("#errorTips").html("请您过60秒在点击发送").show()}if(d==3){if(c==1){$("#errorTips").html("您没有足够多的人民币").show()}if(c==2){$("#errorTips").html("您没有足够多的储备金").show()}}if(d==4){$("#errorTips").html("短信过于频繁，请使用语音验证码").show()}if(d==2){$("#errorTips").html("您的手机号为空或错误，请联系客服。").show()}});return}var wait=60;function time(a){if(wait==0){$(".aButton2").removeClass("aButton2").addClass("aButton1");$(a).html("重新获取验证码");wait=60}else{$(".aButton1").removeClass("aButton1").addClass("aButton2");$(a).html("重新发送("+wait+")");wait--;setTimeout(function(){time(a)},1000)}}$(function(){var b=$("#time").val();function a(c){if(b==0){$(".aButton2").removeClass("aButton2").addClass("aButton1");$(c).html("重新获取验证码");b=100}else{$(".aButton1").removeClass("aButton1").addClass("aButton2");$(c).html("重新发送("+b+")");b--;setTimeout(function(){a(c)},1000)}}if(b>0){a($(".aButton1"))}});function getCoinInfo(a){$.get("/index/infofresh?coin="+a,function(b){if(b.now_price){$("#price_today_ul a[rel='"+a+"'] dd:eq(0)").html("￥"+formatfloat(b.now_price,b.price_float,0))}else{$("#price_today_ul a[rel='"+a+"'] dd:eq(0)").html("0")}if(b.day_total){$("#price_today_ul a[rel='"+a+"'] dd:eq(1)").html(formatfloat(b.day_total,b.number_float,0));$("#price_today_ul a[rel='"+a+"'] dd:eq(2)").html(formatfloat(b.day_money,b.price_float,0))}else{$("#price_today_ul a[rel='"+a+"'] dd:eq(1)").html("0");$("#price_today_ul a[rel='"+a+"'] dd:eq(2)").html("0")}if(b.total_money){$("#price_today_ul a[rel='"+a+"'] dd:eq(3)").html("￥"+formatfloat(b.total_money,b.price_float,0))}else{$("#price_today_ul a[rel='"+a+"'] dd:eq(3)").html("0")}if(b.day_float>0){$("#price_today_ul a[rel='"+a+"'] dd:eq(4)").attr("class","green").html("+"+formatfloat(b.day_float*100,2,0)+"%")}else{$("#price_today_ul a[rel='"+a+"'] dd:eq(4)").attr("class","red").html(formatfloat(b.day_float*100,2,0)+"%")}if(b.week_float>0){$("#price_today_ul a[rel='"+a+"'] dd:eq(5)").attr("class","green").html("+"+formatfloat(b.week_float*100,2,0)+"%")}else{$("#price_today_ul a[rel='"+a+"'] dd:eq(5)").attr("class","red").html(formatfloat(b.week_float*100,2,0)+"%")}setTimeout('getCoinInfo("'+a+'")',6000)},"json")};