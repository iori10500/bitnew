KindEditor.plugin("emoticons",function(c){var f=this,d="emoticons",e=(f.emoticonsPath||f.pluginsPath+"emoticons/images/"),a=f.allowPreviewEmoticons===undefined?true:f.allowPreviewEmoticons,b=1;f.clickToolbar(d,function(){var u=5,j=9,x=135,v=0,i=u*j,q=Math.ceil(x/i),k=Math.floor(j/2),y=c('<div class="ke-plugin-emoticons"></div>'),n=[],o=f.createMenu({name:d,beforeRemove:function(){t()}});o.div.append(y);var r,s;if(a){r=c('<div class="ke-preview"></div>').css("right",0);s=c('<img class="ke-preview-img" src="'+e+v+'.gif" />');y.append(r);r.append(s)}function g(z,A,B){if(r){z.mouseover(function(){if(A>k){r.css("left",0);r.css("right","")}else{r.css("left","");r.css("right",0)}s.attr("src",e+B+".gif");c(this).addClass("ke-on")})}else{z.mouseover(function(){c(this).addClass("ke-on")})}z.mouseout(function(){c(this).removeClass("ke-on")});z.click(function(C){f.insertHtml('<img src="'+e+B+'.gif" border="0" alt="" />').hideMenu().focus();C.stop()})}function l(D,E){var H=document.createElement("table");E.append(H);if(r){c(H).mouseover(function(){r.show("block")});c(H).mouseout(function(){r.hide()});n.push(c(H))}H.className="ke-table";H.cellPadding=0;H.cellSpacing=0;H.border=0;var C=(D-1)*i+v;for(var A=0;A<u;A++){var F=H.insertRow(A);for(var B=0;B<j;B++){var z=c(F.insertCell(B));z.addClass("ke-cell");g(z,B,C);var G=c('<span class="ke-img"></span>').css("background-position","-"+(24*C)+"px 0px").css("background-image","url("+e+"static.gif)");z.append(G);n.push(z);C++}}return H}var w=l(b,y);function t(){c.each(n,function(){this.unbind()})}var p;function h(z,A){z.click(function(B){t();w.parentNode.removeChild(w);p.remove();w=l(A,y);m(A);b=A;B.stop()})}function m(A){p=c('<div class="ke-page"></div>');y.append(p);for(var B=1;B<=q;B++){if(A!==B){var z=c('<a href="javascript:;">['+B+"]</a>");h(z,B);p.append(z);n.push(z)}else{p.append(c("@["+B+"]"))}p.append(c("@&nbsp;"))}}m(b)})});