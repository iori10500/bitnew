/* layer弹层组件拓展类 */
!function(){layer.use("skin/layer.ext.css",function(){layer.layui_layer_extendlayerextjs=!0});var c=layer.cache,d=function(a){return c.skin?" "+c.skin+" "+c.skin+"-"+a:""};layer.prompt=function(b,f){b=b||{},"function"==typeof b&&(f=b);var g,h=2==b.formType?'<textarea class="layui-layer-input">'+(b.value||"")+"</textarea>":function(){return'<input type="'+(1==b.formType?"password":"text")+'" class="layui-layer-input" value="'+(b.value||"")+'">'}();return layer.open($.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:h,skin:"layui-layer-prompt"+d("prompt"),success:function(e){g=e.find(".layui-layer-input"),g.focus()},yes:function(a){var i=g.val();""===i?g.focus():i.length>(b.maxlength||500)?layer.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(b.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",g,{tips:1}):f&&f(i,a,g)}},b))},layer.tab=function(b){b=b||{};var e=b.tab||{};return layer.open($.extend({type:1,skin:"layui-layer-tab"+d("tab"),title:function(){var f=e.length,g=1,h="";if(f>0){for(h='<span class="layui-layer-tabnow">'+e[0].title+"</span>";f>g;g++){h+="<span>"+e[g].title+"</span>"}}return h}(),content:'<ul class="layui-layer-tabmain">'+function(){var f=e.length,g=1,h="";if(f>0){for(h='<li class="layui-layer-tabli xubox_tab_layer">'+(e[0].content||"no content")+"</li>";f>g;g++){h+='<li class="layui-layer-tabli">'+(e[g].content||"no  content")+"</li>"}}return h}()+"</ul>",success:function(f){var g=f.find(".layui-layer-title").children(),h=f.find(".layui-layer-tabmain").children();g.on("mousedown",function(i){i.stopPropagation?i.stopPropagation():i.cancelBubble=!0;var j=$(this),k=j.index();j.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"),h.eq(k).show().siblings().hide()})}},b))},layer.photos=function(b,m,n){function o(e,f,g){var h=new Image;h.onload=function(){h.onload=null,f(h)},h.onerror=function(i){h.onload=null,g(i)},h.src=e}var p={};if(b=b||{},b.photos){var q=b.photos.constructor===Object,r=q?b.photos:{},s=r.data||[],t=r.start||0;if(p.imgIndex=t+1,q){if(0===s.length){return void layer.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}}else{var u=$(b.photos),v=u.find(b.img||"img");if(0===v.length){return}if(m||u.find(r.img||"img").each(function(a){var e=$(this);s.push({alt:e.attr("alt"),pid:e.attr("layer-pid"),src:e.attr("layer-src")||e.attr("src"),thumb:e.attr("src")}),e.on("click",function(){layer.photos($.extend(b,{photos:{start:a,data:s,tab:b.tab},full:b.full}),!0)})}),!m){return}}p.imgprev=function(e){p.imgIndex--,p.imgIndex<1&&(p.imgIndex=s.length),p.tabimg(e)},p.imgnext=function(e){p.imgIndex++,p.imgIndex>s.length&&(p.imgIndex=1),p.tabimg(e)},p.keyup=function(e){if(!p.end){var f=e.keyCode;e.preventDefault(),37===f?p.imgprev(!0):39===f?p.imgnext(!0):27===f&&layer.close(p.index)}},p.tabimg=function(a){r.start=p.imgIndex-1,layer.close(p.index),layer.photos(b,!0,a)},p.event=function(){p.bigimg.hover(function(){p.imgsee.show()},function(){p.imgsee.hide()}),p.bigimg.find(".layui-layer-imgprev").on("click",function(e){e.preventDefault(),p.imgprev()}),p.bigimg.find(".layui-layer-imgnext").on("click",function(e){e.preventDefault(),p.imgnext()}),$(document).on("keyup",p.keyup)},p.loadi=layer.load(1,{shade:"shade" in b?!1:0.9,scrollbar:!1}),o(s[t].src,function(a){layer.close(p.loadi),p.index=layer.open($.extend({type:1,area:function(){var e=[a.width,a.height],f=[$(window).width()-100,$(window).height()-100];return !b.full&&e[0]>f[0]&&(e[0]=f[0],e[1]=e[0]*f[1]/e[0]),[e[0]+"px",e[1]+"px"]}(),title:!1,shade:0.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos"+d("photos"),content:'<div class="layui-layer-phimg"><img src="'+s[t].src+'" alt="'+(s[t].alt||"")+'" layer-pid="'+s[t].pid+'"><div class="layui-layer-imgsee"><span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span><div class="layui-layer-imgbar" style="display:'+(n?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(s[t].alt||"")+"</a><em>"+p.imgIndex+"/"+s.length+"</em></span></div></div></div>",success:function(e,f){p.bigimg=e.find(".layui-layer-phimg"),p.imgsee=e.find(".layui-layer-imguide,.layui-layer-imgbar"),p.event(e),b.tab&&b.tab(s[t],e)},end:function(){p.end=!0,$(document).off("keyup",p.keyup)}},b))},function(){layer.close(p.loadi),layer.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;",{time:2000},function(){s.length>1&&p.imgnext(!0)})})}}}();