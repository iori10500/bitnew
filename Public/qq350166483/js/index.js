var index=function(){var a=this;this.btn=$("#loginbtn");this.loading="<div id='loading'><img src='/Public/Home/images/loading.gif' /></div>";this.btn.click(function(){a.login()});document.onkeypress=function(){if(event.keyCode==13){a.login()}}};index.prototype={login:function(){var a=this;$("body").append(a.loading);$.post(_barr.login,$("#loginform").serialize(),function(b){$("#loading").remove();layer.msg(b.info);if(b.status==1){window.location.href="/Safe/index"}else{if(b.status==3){$(".captcha").removeClass("hide");$(".login").addClass("top3em")}else{if(b.status==6){$(".google").removeClass("hide");$(".login").addClass("top3em")}}}})}};new index;$(function(){$(".homepage-lump .col-sm-2").hover(function(){$(this).addClass("current")},function(){$(this).removeClass("current")});$(".flexslider").flexslider({directionNav:true,pauseOnAction:false});$(".for_coin li").click(function(){$(this).addClass("selectTag");$(this).siblings().removeClass("selectTag");var c=$(this).data("qu");$(".coin_list>tbody>tr").addClass("hide");$(".coin_list>tbody>."+c).removeClass("hide")});var b=function(){var c=this;c.webCoin();c.okCoin();c.poloCoin();setInterval(function(){c.getCoinMarket();c.webCoin();c.okCoin();c.poloCoin()},10000)};var a=Handlebars.compile($("#table-template").html());b.prototype={webCoin:function(){var c=this;$("#web_coin>.coin_num").each(function(){var d=$(this).data("mark");$.getJSON("https://api.huobi.com/staticmarket/"+d+"_kline_100_json.js?length=1",function(e){var f=Math.floor(((e[0][4]-e[0][1])/e[0][4])*10000);$("#web_coin>.coin"+d+">.change24>a").removeClass();if(f>0){$("#web_coin>.coin"+d+">.change24>a").addClass("text-red");$("#web_coin>.coin"+d+">.change24>a").text("+"+f/100+"%")}else{$("#web_coin>.coin"+d+">.change24>a").addClass("text-green");$("#web_coin>.coin"+d+">.change24>a").text(f/100+"%")}});$.getJSON("https://api.huobi.com/staticmarket/detail_"+d+"_json.js",function(e){$("#web_coin>.coin"+d+">.new_price>a").removeClass();if(e.p_last>e.p_open){$("#web_coin>.coin"+d+">.new_price>a").text(e.p_last+"CNY↑");$("#web_coin>.coin"+d+">.new_price>a").addClass("text-red")}else{$("#web_coin>.coin"+d+">.new_price>a").addClass("text-green");$("#web_coin>.coin"+d+">.new_price>a").text(e.p_last+"CNY↓")}$("#web_coin>.coin"+d+">.num24>a").text(e.amount);$("#web_coin>.coin"+d+">.money24>a").text(e.total.toFixed(2)+" CNY")})})},okCoin:function(){var c=this;$("#ok_coin>.coin_num").each(function(){var d=$(this).data("mark");var e=d+"_cny";$.getJSON("/Okcoin/get_kline",{symbol:e,type:"1day",size:1},function(f){window.level=Math.floor(((f[0][4]-f[0][1])/f[0][4])*10000);$("#ok_coin>.coin"+d+">.change24>a").removeClass();if(window.level>0){$("#ok_coin>.coin"+d+">.change24>a").addClass("text-red");$("#ok_coin>.coin"+d+">.change24>a").text("+"+level/100+"%")}else{$("#ok_coin>.coin"+d+">.change24>a").addClass("text-green");$("#ok_coin>.coin"+d+">.change24>a").text(level/100+"%")}});$.getJSON("/Okcoin/get_ticker",{symbol:e},function(f){$("#ok_coin>.coin"+d+">.new_price>a").removeClass();if(window.level>0){$("#ok_coin>.coin"+d+">.new_price>a").text(f[2]+"CNY↑");$("#ok_coin>.coin"+d+">.new_price>a").addClass("text-red")}else{$("#ok_coin>.coin"+d+">.new_price>a").addClass("text-green");$("#ok_coin>.coin"+d+">.new_price>a").text(f[2]+"CNY↓")}$("#ok_coin>.coin"+d+">.num24>a").text(f[5]);$("#ok_coin>.coin"+d+">.money24>a").text((f[5]*f[2]).toFixed(2)+" CNY")})})},poloCoin:function(){var c=this;$.get(_barr.jsons+"?call=get_polo_ticker",function(d){if(d==""||typeof(d)=="undefined"||d==0){return false}$("#polo_coin>.coin_num").each(function(){var f=$(this).data("mark");var e=d[f]["percentChange"];$(this).find(".change24>a").removeClass();$(this).find(".new_price>a").removeClass();$(this).find(".num24>a").text(d[f]["quoteVolume"]);$(this).find(".money24>a").text(d[f]["total"]+" CNY");if(e>0){$(this).find(".change24>a").addClass("text-red");$(this).find(".new_price>a").addClass("text-red");$(this).find(".change24>a").text("+"+e+"%");$(this).find(".new_price>a").text(d[f]["last"]+"CNY↑")}else{$(this).find(".change24>a").addClass("text-green");$(this).find(".new_price>a").addClass("text-green");$(this).find(".change24>a").text(e+"%");$(this).find(".new_price>a").text(d[f]["last"]+"CNY↓")}})})},wan:function(d){var c=parseInt(d);if(c>10000){return c=parseInt(c/100)/100+"万"}else{return c}},getCoinMarket:function(){$.post(_barr.currency_list,{k:1},function(c){if(c==null){window.location.reload()}Handlebars.registerHelper("check",function(d){if(d==null){return"0.00"}else{return d}});Handlebars.registerHelper("pstatus",function(d){if(d==1){return"↑"}else{return"↓"}});Handlebars.registerHelper("ctype",function(d){if(d>=0||d==null){return"text-red"}else{return"text-green"}});Handlebars.registerHelper("tcss",function(d){if(d==1){return"text-red"}else{return"text-green"}});Handlebars.registerHelper("cstatus",function(d){if(d>=0||d==null){return"+"}});Handlebars.registerHelper("qu",function(e){var d=$(".selectTag").data("qu").replace("qu","");if(parseInt(d)==e){return"qu"+e}else{return"hide qu"+e}});$("#market").html(a(c))})}};new b});